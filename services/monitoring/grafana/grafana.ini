# ============================================================================
# Grafana Configuration
# ============================================================================
# Official docs: https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/
# ============================================================================

[paths]
# Data and logs
data = /var/lib/grafana
logs = /var/log/grafana
plugins = /var/lib/grafana/plugins
provisioning = /etc/grafana/provisioning

[server]
# Server settings (overridden by environment variables)
protocol = http
http_port = 3000
domain = monitor.mykyta-ryasny.dev
root_url = https://monitor.mykyta-ryasny.dev
serve_from_sub_path = false

# Enable gzip compression
enable_gzip = true

[database]
# Use SQLite for simplicity (can upgrade to PostgreSQL later)
type = sqlite3
path = /var/lib/grafana/grafana.db

# WAL mode for better concurrency
wal = true

[session]
# Session settings
provider = file
provider_config = sessions

[security]
# Security settings
admin_user = admin
admin_password = admin  # Change this!

# Cookie security
cookie_secure = true
cookie_samesite = lax

# Content security
disable_gravatar = true

# Password policy
password_policy = true
password_length = 12

[users]
# User management
allow_sign_up = false
allow_org_create = false
auto_assign_org = true
auto_assign_org_role = Viewer
default_theme = dark

[auth]
# Disable authentication for viewing (optional)
# Useful if you want to embed dashboards
disable_login_form = false
# Enable signout menu - it will call Authelia's logout API
# via the signout_redirect_url configured in auth.proxy section
disable_signout_menu = false

[auth.anonymous]
# Enable anonymous access (optional)
# Allows viewing dashboards without login
enabled = false
org_name = Main Org.
org_role = Viewer

[auth.basic]
# Basic authentication
enabled = true

[auth.proxy]
# Enable auth proxy (Authelia forward auth)
enabled = true
# Header name containing the username
header_name = Remote-User
# Header containing the user's email
header_property = email
# Auto-create users from headers
auto_sign_up = true
# Sync user info from headers on every login
sync_ttl = 60
# Whitelist of proxy IP addresses (Caddy container)
whitelist =
# Enable LDAP lookup (we're not using LDAP)
enable_login_token = false
# Logout redirect URL (where to send users when they try to logout)
# Redirects to Authelia's logout page (handles session cleanup)
signout_redirect_url = https://auth.mykyta-ryasny.dev/logout

[analytics]
# Disable analytics and telemetry
reporting_enabled = false
check_for_updates = false
check_for_plugin_updates = false

[snapshots]
# External snapshot sharing
external_enabled = false

[dashboards]
# Dashboard settings
# default_home_dashboard_path = /etc/grafana/provisioning/dashboards/home.json

# Auto-refresh settings
min_refresh_interval = 5s

[explore]
# Enable Explore feature (for ad-hoc log queries)
enabled = true

[alerting]
# Legacy alerting (DISABLED - using unified alerting instead)
enabled = false
execute_alerts = false

[unified_alerting]
# New unified alerting system (Grafana 8+)
enabled = true

[log]
# Logging
mode = console
level = info

[log.console]
# Console logging format
format = text

[metrics]
# Internal metrics (optional, for monitoring Grafana itself)
enabled = true
interval_seconds = 10

[tracing]
# OpenTelemetry tracing (optional)
enabled = false

[grafana_com]
# Grafana.com integration
url = https://grafana.com

[external_image_storage]
# Image storage for alert notifications
provider = local

[rendering]
# Image rendering (for alert images)
server_url =
callback_url =

[panels]
# Panel settings
disable_sanitize_html = false

[plugins]
# Plugin settings
enable_alpha = false
app_tls_skip_verify_insecure = false

[live]
# Grafana Live (real-time features)
max_connections = 100
