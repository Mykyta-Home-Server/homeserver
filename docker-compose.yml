# ============================================================================
# Home Server - Docker Compose Configuration
# ============================================================================
# Services organized by category in compose/ directory
#
# Environment variables loaded from .env file
#
# ============================================================================
# Docker Compose Profiles
# ============================================================================
# This project uses profiles to control which services start:
#
# DEFAULT (no profile):
#   docker compose up -d
#   → Starts: Infrastructure + Authentication
#   → Services: caddy, cloudflared, postgres-auth, redis-auth, authelia,
#               openldap, phpldapadmin, user-management
#
# PROFILES:
#   --profile web         : Web applications (portal, hello-world)
#   --profile media       : Media stack (Jellyfin, Sonarr, Radarr, etc.)
#   --profile monitoring  : Monitoring (Grafana, Loki, Promtail, Uptime Kuma)
#   --profile cicd        : GitHub Actions runner
#   --profile all         : Everything
#
# EXAMPLES:
#   # Start infrastructure + auth + media + monitoring
#   docker compose --profile media --profile monitoring up -d
#
#   # Start everything
#   docker compose --profile all up -d
#
#   # Start just core services (infra + auth)
#   docker compose up -d
# ============================================================================

include:
  # Network definitions (must be first)
  - compose/networks.yml

  # Core services (always run - no profile needed)
  - compose/infrastructure.yml  # caddy, cloudflared, github-runner (cicd profile)
  - compose/auth.yml            # All authentication services

  # Optional services (require profiles)
  - compose/web.yml             # Web applications (profile: web, all)
  - compose/media.yml           # Media stack (profile: media, all)
  - compose/monitoring.yml      # Monitoring stack (profile: monitoring, all)
