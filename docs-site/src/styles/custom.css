/* Custom styles for Home Server Docs */
/* Using Starlight's theming system - only override CSS variables */

/* Light mode accent colors */
:root {
  --sl-color-accent-low: #c7d9f2;
  --sl-color-accent: #2563eb;
  --sl-color-accent-high: #1d4ed8;
}

/* Dark mode - use Starlight's dark theme with custom accent */
:root[data-theme='dark'] {
  --sl-color-accent-low: #1e3a5f;
  --sl-color-accent: #60a5fa;
  --sl-color-accent-high: #93c5fd;
}

/* Code block enhancements */
.sl-markdown-content pre {
  border-radius: 0.5rem;
}

/* ============================================
   Mermaid Diagram Styling
   ============================================ */

/* Container styling - make diagrams larger and centered */
.mermaid,
pre.mermaid,
.sl-markdown-content .mermaid,
.astro-mermaid {
  position: relative;
  width: 100%;
  max-width: 100%;
  overflow-x: auto;
  padding: 1.5rem;
  padding-bottom: 2.5rem;
  margin: 1.5rem 0;
  background: var(--sl-color-bg-nav);
  border-radius: 1rem;
  border: 1px solid var(--sl-color-hairline);
  cursor: zoom-in;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.mermaid:hover,
.astro-mermaid:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Make SVG responsive and larger */
.mermaid svg,
.astro-mermaid svg {
  max-width: 100%;
  height: auto;
  min-height: 200px;
  display: block;
  margin: 0 auto;
}

/* Click-to-expand modal overlay */
.mermaid-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.9);
  z-index: 9999;
  cursor: zoom-out;
  backdrop-filter: blur(8px);
  animation: fadeIn 0.2s ease;
}

.mermaid-modal.active {
  display: flex;
  align-items: center;
  justify-content: center;
}

.mermaid-modal .mermaid-content {
  width: 90vw;
  height: 85vh;
  overflow: auto;
  background: var(--sl-color-bg);
  padding: 2rem;
  border-radius: 1rem;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
}

.mermaid-modal .mermaid-content svg {
  width: 100% !important;
  height: auto !important;
  max-height: 80vh;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Close button for modal */
.mermaid-modal-close {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  font-size: 2rem;
  color: white;
  background: rgba(255, 255, 255, 0.15);
  border: none;
  border-radius: 50%;
  width: 3rem;
  height: 3rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s;
  z-index: 10000;
}

.mermaid-modal-close:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* ============================================
   Mermaid Pastel Colors & Rounded Nodes
   Applied to both page and modal SVGs
   ============================================ */

/* Flowchart nodes - pastel backgrounds with rounded corners */
.mermaid .node rect,
.mermaid .node polygon,
.mermaid .node circle,
.mermaid .node ellipse,
.mermaid-modal .node rect,
.mermaid-modal .node polygon,
.mermaid-modal .node circle,
.mermaid-modal .node ellipse {
  rx: 12px;
  ry: 12px;
  stroke-width: 2px;
}

/* Pastel color palette for light mode */
:root {
  --mermaid-primary: #a8d5ff;
  --mermaid-primary-text: #1a365d;
  --mermaid-secondary: #c3f0ca;
  --mermaid-secondary-text: #1a4d2e;
  --mermaid-tertiary: #ffd9a8;
  --mermaid-tertiary-text: #5c3d00;
  --mermaid-note: #ffe4f3;
  --mermaid-note-text: #831843;
  --mermaid-line: #94a3b8;
}

/* Pastel color palette for dark mode */
:root[data-theme='dark'] {
  --mermaid-primary: #1e4976;
  --mermaid-primary-text: #93c5fd;
  --mermaid-secondary: #1a4d2e;
  --mermaid-secondary-text: #86efac;
  --mermaid-tertiary: #5c3d00;
  --mermaid-tertiary-text: #fcd34d;
  --mermaid-note: #4a1d36;
  --mermaid-note-text: #f9a8d4;
  --mermaid-line: #64748b;
}

/* Apply pastel colors to nodes - include modal selectors */
.mermaid .node.default > rect,
.mermaid .node.default > polygon,
.mermaid-modal .node.default > rect,
.mermaid-modal .node.default > polygon {
  fill: var(--mermaid-primary) !important;
  stroke: var(--mermaid-line) !important;
}

.mermaid .nodeLabel,
.mermaid .node .label,
.mermaid-modal .nodeLabel,
.mermaid-modal .node .label {
  color: var(--mermaid-primary-text) !important;
  fill: var(--mermaid-primary-text) !important;
}

/* Edge/arrow styling */
.mermaid .edgePath path.path,
.mermaid .flowchart-link,
.mermaid-modal .edgePath path.path,
.mermaid-modal .flowchart-link {
  stroke: var(--mermaid-line) !important;
  stroke-width: 2px;
}

.mermaid marker path,
.mermaid-modal marker path {
  fill: var(--mermaid-line) !important;
}

/* Edge labels */
.mermaid .edgeLabel,
.mermaid-modal .edgeLabel {
  background: var(--sl-color-bg) !important;
  border-radius: 0.5rem;
  padding: 0.25rem 0.5rem;
}

/* Subgraph styling */
.mermaid .cluster rect,
.mermaid-modal .cluster rect {
  fill: var(--mermaid-note) !important;
  stroke: var(--mermaid-line) !important;
  rx: 16px !important;
  ry: 16px !important;
}

.mermaid .cluster .nodeLabel,
.mermaid-modal .cluster .nodeLabel {
  color: var(--mermaid-note-text) !important;
}

/* Sequence diagram specific */
.mermaid .actor,
.astro-mermaid .actor,
.mermaid-modal .actor {
  fill: var(--mermaid-primary) !important;
  stroke: var(--mermaid-line) !important;
  rx: 8px !important;
  ry: 8px !important;
}

.mermaid .actor-line,
.astro-mermaid .actor-line,
.mermaid-modal .actor-line {
  stroke: var(--mermaid-line) !important;
  stroke-dasharray: 4, 4;
}

.mermaid .messageLine0,
.mermaid .messageLine1,
.astro-mermaid .messageLine0,
.astro-mermaid .messageLine1,
.mermaid-modal .messageLine0,
.mermaid-modal .messageLine1 {
  stroke: var(--mermaid-line) !important;
  stroke-width: 1.5px;
}

.mermaid .messageText,
.astro-mermaid .messageText,
.mermaid-modal .messageText {
  fill: var(--sl-color-text) !important;
  font-size: 12px !important;
}

.mermaid .note,
.astro-mermaid .note,
.mermaid-modal .note {
  fill: var(--mermaid-note) !important;
  stroke: var(--mermaid-line) !important;
  rx: 8px !important;
  ry: 8px !important;
}

/* Sequence diagram labels */
.mermaid .actor text,
.mermaid .sequenceNumber,
.astro-mermaid .actor text,
.astro-mermaid .sequenceNumber,
.mermaid-modal .actor text,
.mermaid-modal .sequenceNumber {
  fill: var(--mermaid-primary-text) !important;
}

/* Sequence diagram loop/alt boxes */
.mermaid .loopLine,
.mermaid .labelBox,
.astro-mermaid .loopLine,
.astro-mermaid .labelBox,
.mermaid-modal .loopLine,
.mermaid-modal .labelBox {
  stroke: var(--mermaid-line) !important;
  fill: var(--sl-color-bg-nav) !important;
}

.mermaid .loopText,
.mermaid .labelText,
.astro-mermaid .loopText,
.astro-mermaid .labelText,
.mermaid-modal .loopText,
.mermaid-modal .labelText {
  fill: var(--sl-color-text) !important;
}

/* Activation boxes */
.mermaid .activation0,
.mermaid .activation1,
.mermaid .activation2,
.astro-mermaid .activation0,
.astro-mermaid .activation1,
.astro-mermaid .activation2,
.mermaid-modal .activation0,
.mermaid-modal .activation1,
.mermaid-modal .activation2 {
  fill: var(--mermaid-secondary) !important;
  stroke: var(--mermaid-line) !important;
}

/* ============================================
   Right Sidebar (On This Page) - Compact
   ============================================ */

/* Make the right sidebar much narrower */
.right-sidebar {
  width: 10rem !important;
}

.right-sidebar-panel {
  padding: 0.5rem !important;
}

/* TOC links smaller */
starlight-toc a {
  font-size: 0.75rem !important;
}

@media (min-width: 72rem) {
  /* More content space */
  .sl-container {
    max-width: calc(100% - 10rem);
  }
}

/* Hint text for clickable diagrams - positioned at bottom center */
.mermaid::after,
.astro-mermaid::after {
  content: "Click to expand";
  position: absolute;
  bottom: 0.5rem;
  left: 50%;
  transform: translateX(-50%);
  font-size: 0.7rem;
  color: var(--sl-color-gray-4);
  background: var(--sl-color-bg-nav);
  padding: 0.2rem 0.75rem;
  border-radius: 1rem;
  opacity: 0.8;
  pointer-events: none;
}
